v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 1) +
scale_y_continuous(labels = scales::percent) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
library(ggplot2)
library(dplyr)
library(cowplot)
library(ggsci)
library(tidyverse)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 1) +
scale_y_continuous(labels = scales::percent) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
help("stat_function")
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
#scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
m
library(ggplot2)
library(dplyr)
library(cowplot)
library(ggsci)
library(tidyverse)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
#scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
m
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
#scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
#scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
help("stat_function")
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
#geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
#scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
#geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 1) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n(24)
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 2) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 10) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 0.5) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 0.1) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
binw <- 0.1
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = binw) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v*binw*560)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
help(sd)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- sd(d)/n
dados <- data.frame(d)
binw <- 0.1
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = binw) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v*binw*560)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- sd(d)/n
dados <- data.frame(d)
binw <- 0.1
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = binw) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v*binw)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- sd(d)/n
dados <- data.frame(d)
binw <- 0.1
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = binw) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v*binw*100)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- sd(d)/n
dados <- data.frame(d)
binw <- 0.1
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = binw) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v*binw*50)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- sd(d)/n
dados <- data.frame(d)
binw <- 0.1
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = binw) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v*binw*40)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
seed <- 406
m <- 1450
n <- 1340
lambda <- 0.96
a <- 1 - 0.96
set.seed(seed)
dados <- rexp(n ,lambda)
replicate(m, rexp(n ,lambda))
dados <- replicate(m, rexp(n ,lambda))
View(dados)
dnorm((1+gama)/2)
gama <- 0.96
dnorm((1+gama)/2)
dnorm(0.95)
dnorm(0.95)
dnorm(0.975)
qnorm(0.975)
seed <- 406
m <- 1450
n <- 1340
lambda <- 0.96
gama <- 0.96
a <- qnorm((1+gama)/2)
c <- a/sqrt(n)
set.seed(seed)
dados <- numeric(m)
for(i in 1:m) {
avg <- mean(rexp(n ,lambda))
dados[i] <- ((1-c)/avg) - ((1+c)/avg)
}
mean(dados)
library(dplyr)
diff <- function(lambda, seed, n, x) {
set.seed(seed)
rand <- data.frame(rexp(n, lambda))
rand2 <- filter(rand, rand > x)
estim <- length(rand2[,1])/length(rand[,1])
teo <- exp(-lambda*x)
return(abs(teo - estim))
}
diff(0.28, 1387, 633, 5)
library(dplyr)
diff <- function(lambda, seed, n, x) {
set.seed(seed)
rand <- data.frame(rexp(n, lambda))
rand2 <- filter(rand, rand > x)
estim <- length(rand2[,1])/length(rand[,1])
teo <- exp(-lambda*x)
return(abs(teo - estim))
}
diff(0.28, 1387, 633, 5)
setwd("~/Trabalhos/Educação/21.22 IST/2º Semestre/PE/Projeto/Pergunta 6")
library(ggplot2)
grafico_com_n <- function(n, seed, samples, a, b) {
# Geração dos dados
set.seed(seed)
d <- replicate(samples, mean(runif(n, a, b)))
# Criação de uma distribuição normal com a mesma média e variância
X <- seq(from = a, to = b, length.out = samples)
f.X <- dnorm(X, mean = (a+b)/2, sd = sqrt(((b-a)^2)/(12*n)))
#Criação do data frame
dados <- data.frame(d, X, f.X)
# Desenho do gráfico com os dados
return(ggplot(dados, aes(d)) +
geom_histogram(aes(y = after_stat(count / sum(count)), fill = "Médias"),
binwidth = 0.2, color="white") +
geom_line(aes(x = X, y = f.X, color = "Normal")) +
scale_y_continuous(labels = scales::percent) + xlim(a, b) +
scale_color_manual(values = c("Normal" = "firebrick2"), name = NULL) +
scale_fill_manual(values = c("Médias" = "deepskyblue"), name = NULL) +
labs(fill = "Médias", color = "Normal", subtitle = sprintf("n = %s", n),
title = "Distribuição de médias de distribuições uniformes",
x = "Valores da distribuição da média", y = "Frequência relativa"))
}
# Ciclo de geração dos gráficos para cada n
for(n in c(3, 24, 75)) {
plot <- grafico_com_n(n, seed=872, samples=560, a=9, b=13)
# Guarda o plot como imagem
ggsave(sprintf("Plot%s.png", n), plot, width = 1920, height = 1080, units = "px")
}
