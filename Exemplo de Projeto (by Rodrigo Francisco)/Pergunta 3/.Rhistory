diff <- abs(teo - estim)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 1) +
scale_y_continuous(labels = scales::percent) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
library(ggplot2)
library(dplyr)
library(cowplot)
library(ggsci)
library(tidyverse)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 1) +
scale_y_continuous(labels = scales::percent) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
help("stat_function")
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
#scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
m
library(ggplot2)
library(dplyr)
library(cowplot)
library(ggsci)
library(tidyverse)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
#scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
m
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
#scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
#scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
help("stat_function")
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
#geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
#scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
#geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 1) +
stat_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 1) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n(24)
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 2) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 10) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 0.5) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = 0.1) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- var(d)/n
dados <- data.frame(d)
binw <- 0.1
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = binw) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v*binw*560)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
help(sd)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- sd(d)/n
dados <- data.frame(d)
binw <- 0.1
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = binw) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v*binw*560)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- sd(d)/n
dados <- data.frame(d)
binw <- 0.1
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = binw) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v*binw)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- sd(d)/n
dados <- data.frame(d)
binw <- 0.1
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = binw) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v*binw*100)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- sd(d)/n
dados <- data.frame(d)
binw <- 0.1
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = binw) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v*binw*50)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
grafico_com_n <- function(n) {
set.seed(872)
d <- numeric(560)
for (x in 1:560) d[x] <- mean(runif(n, 9, 13))
m <- mean(d)
print(m)
v <- sd(d)/n
dados <- data.frame(d)
binw <- 0.1
g <- ggplot(dados) +
geom_histogram(aes(d, stat(density), fill = "médias"), binwidth = binw) +
geom_function(aes(color = "normal"), fun = dnorm, n = 100,
args = list(mean = m, sd = v*binw*40)) +
scale_y_continuous(labels = scales::percent) +
scale_color_manual(values = c("normal" = "firebrick"), labels = NULL) +
scale_fill_manual(values = c("médias" = "deepskyblue"), labels = NULL) +
labs(fill = "Médias", color = "Normal")
g
# ggsave(paste("Plot", n, ".png"), plot, width = 1920, height = 1080, units = "px")
}
grafico_com_n(3)
seed <- 406
m <- 1450
n <- 1340
lambda <- 0.96
a <- 1 - 0.96
set.seed(seed)
dados <- rexp(n ,lambda)
replicate(m, rexp(n ,lambda))
dados <- replicate(m, rexp(n ,lambda))
View(dados)
dnorm((1+gama)/2)
gama <- 0.96
dnorm((1+gama)/2)
dnorm(0.95)
dnorm(0.95)
dnorm(0.975)
qnorm(0.975)
seed <- 406
m <- 1450
n <- 1340
lambda <- 0.96
gama <- 0.96
a <- qnorm((1+gama)/2)
c <- a/sqrt(n)
set.seed(seed)
dados <- numeric(m)
for(i in 1:m) {
avg <- mean(rexp(n ,lambda))
dados[i] <- ((1-c)/avg) - ((1+c)/avg)
}
mean(dados)
library(dplyr)
diff <- function(lambda, seed, n, x) {
set.seed(seed)
rand <- data.frame(rexp(n, lambda))
rand2 <- filter(rand, rand > x)
estim <- length(rand2[,1])/length(rand[,1])
teo <- exp(-lambda*x)
return(abs(teo - estim))
}
diff(0.28, 1387, 633, 5)
library(dplyr)
diff <- function(lambda, seed, n, x) {
set.seed(seed)
rand <- data.frame(rexp(n, lambda))
rand2 <- filter(rand, rand > x)
estim <- length(rand2[,1])/length(rand[,1])
teo <- exp(-lambda*x)
return(abs(teo - estim))
}
diff(0.28, 1387, 633, 5)
setwd("~/Trabalhos/Educação/21.22 IST/2º Semestre/PE/Projeto/Pergunta 2")
setwd("~/Trabalhos/Educação/21.22 IST/2º Semestre/PE/Projeto/Pergunta 1")
setwd("~/Trabalhos/Educação/21.22 IST/2º Semestre/PE/Projeto/Pergunta 3")
library(dplyr)
diff <- function(lambda, seed, n, x) {
set.seed(seed)
rand <- data.frame(rexp(n, lambda))
rand2 <- filter(rand, rand > x)
estim <- length(rand2[,1])/length(rand[,1])
teo <- exp(-lambda*x)
return(abs(teo - estim))
}
diff(0.28, 1387, 633, 5)
diff <- function(seed, samples, size, n, p) {
set.seed(seed)
return(abs(mean(replicate(samples, mean(rbinom(size, n, p)))) - n*p))
}
diff(seed=1429, samples=8225, size=70, n=14, p=0.32)
m_ic <- function(seed, m, n, lambda, gama) {
set.seed(seed)
return(mean(replicate(m, (2*(qnorm((1+gama)/2)/sqrt(n)))/(mean(rexp(n ,lambda))))))
}
m_ic(seed=406, m=1450, n=1340, lambda=0.96, gama=0.96)
